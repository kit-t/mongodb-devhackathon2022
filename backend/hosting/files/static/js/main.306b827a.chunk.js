(this["webpackJsonpmongodb-devhackathon-2022"]=this["webpackJsonpmongodb-devhackathon-2022"]||[]).push([[0],{138:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(14),o=n.n(c),i=(n(138),n(4)),s=n.n(i),u=n(10),l=n(13),d=n(227),f=n(228),p=n(229),b=n(221),j=n(194),h=n(124),m=n.n(h),v=n(8),O=n(34),x=n(218),g=n(219),w=n(230),y=n(220),k=n(108),C=n(120),S=n.n(C),I=n(121),E=n.n(I),A=n(48),U=n(5);function D(e){return new O.a({id:e,baseUrl:A.b})}var T=a.a.createContext(null);function R(e){var t=e.appId,n=e.children,r=a.a.useState(D(t)),c=Object(l.a)(r,2),o=c[0],i=c[1];a.a.useEffect((function(){i(D(t))}),[t]);var d=a.a.useState(o.currentUser),f=Object(l.a)(d,2),p=f[0],b=f[1],j=a.a.useCallback(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.currentUser||!t){e.next=5;break}return e.next=3,null===p||void 0===p?void 0:p.logOut();case 3:return e.next=5,o.removeUser(p);case 5:return e.next=7,o.logIn(t);case 7:b(o.currentUser);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,p]),h=a.a.useCallback(Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===p||void 0===p?void 0:p.logOut();case 2:return e.next=4,o.removeUser(p);case 4:return e.next=6,o.logIn(O.b.anonymous());case 6:b(o.currentUser);case 7:case"end":return e.stop()}}),e)}))),[o,p]),m=a.a.useMemo((function(){return Object(v.a)(Object(v.a)({},o),{},{currentUser:p,logIn:j,logOut:h})}),[o,p,j,h]);return Object(U.jsx)(T.Provider,{value:m,children:n})}function P(){var e=a.a.useContext(T);if(!e)throw new Error("No Realm App found. Make sure to call useRealmApp() inside of a <RealmAppProvider />.");return e}var _=n(25),L=function(e){return!e},N=function(e,t){return!(t<0||t>=e.length)};var B=n(231);function F(e){return Object(U.jsx)(B.a,Object(v.a)({elevation:6,variant:"filled"},e))}function M(e){var t=e.isOpen,n=e.message,r=e.onClose,a=void 0===r?function(){}:r;return t?Object(U.jsx)(F,{onClose:a,severity:"error",children:n}):null}function q(){var e,t,n=P(),r=a.a.useState(!1),c=Object(l.a)(r,2),o=c[0],i=c[1],d={email:null,password:null,other:null},f=a.a.useState(d),p=Object(l.a)(f,2),h=p[0],m=p[1],C=function(){return m(d)},I=function(e){var t=e.error,n=e.clearError,r=e.hideAfterMs,c=a.a.useState(!1),o=Object(l.a)(c,2),i=o[0],s=o[1],u=a.a.useCallback((function(){n(),s(!1)}),[n]);return a.a.useEffect((function(){if(t){if(s(!0),r){var e=setTimeout((function(){u()}),r);return function(){clearTimeout(e)}}}else s(!1)}),[t,u,r]),function(){return Object(U.jsx)(M,{isOpen:i,message:t,onClose:function(){u()}})}}({error:h.other,clearError:function(){m((function(e){return Object(v.a)(Object(v.a)({},e),{},{other:null})}))}}),A=a.a.useState(!1),D=Object(l.a)(A,2),T=D[0],R=D[1],_=function(){var e=Object(u.a)(s.a.mark((function e(t){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.email,a=t.password,C(),e.prev=2,!o){e.next=6;break}return e.next=6,n.emailPasswordAuth.registerUser(r,a);case 6:return e.next=8,n.logIn(O.b.emailPassword(r,a));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),J(e.t0,m);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsx)(x.a,{maxWidth:"sm",className:"main-container",children:Object(U.jsx)(g.a,{className:"auth-card",variant:"outlined",children:Object(U.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault();var t=new FormData(e.target),n=Object.fromEntries(t.entries()),r=n.email,a=n.password;_({email:r,password:a})},children:[Object(U.jsx)(j.a,{component:"h2",variant:"h4",gutterBottom:!0,children:o?"Sign Up":"Log In"}),Object(U.jsx)(I,{}),Object(U.jsx)(w.a,{id:"input-email",name:"email",label:"Email Address",variant:"outlined",error:Boolean(h.email),helperText:null!==(e=h.email)&&void 0!==e?e:""}),Object(U.jsx)(w.a,{id:"input-password",type:T?"text":"password",name:"password",label:"Password",variant:"outlined",error:Boolean(h.password),helperText:null!==(t=h.password)&&void 0!==t?t:"",InputProps:{endAdornment:Object(U.jsx)(y.a,{position:"end",children:Object(U.jsx)(k.a,{"aria-label":"toggle password visibility",onClick:function(){return R(L)},onMouseDown:function(e){e.preventDefault()},children:T?Object(U.jsx)(S.a,{}):Object(U.jsx)(E.a,{})})})}}),Object(U.jsx)(b.a,{type:"submit",variant:"contained",color:"primary",children:o?"Create Account":"Log In"}),Object(U.jsx)("button",{type:"button",className:"link-button",onClick:function(){return C(),void i(L)},children:o?"Already have an account? Log In":"Sign up for an account"})]})})})}function J(e,t){var n=function(){t((function(e){return Object(v.a)(Object(v.a)({},e),{},{other:"Something went wrong. Try again in a little bit."})})),console.warn("Something went wrong with a Realm login or signup request. See the following error for details."),console.error(e)};if(e instanceof O.c){var r=e.error,a=e.statusCode;switch(r||a){case"invalid username":t((function(e){return Object(v.a)(Object(v.a)({},e),{},{email:"Invalid email address."})}));break;case"invalid username/password":case"invalid password":case 401:t((function(e){return Object(v.a)(Object(v.a)({},e),{},{password:"Incorrect password."})}));break;case"name already in use":case 409:t((function(e){return Object(v.a)(Object(v.a)({},e),{},{email:"Email is already registered."})}));break;case"password must be between 6 and 128 characters":case 400:t((function(e){return Object(v.a)(Object(v.a)({},e),{},{password:"Password must be between 6 and 128 characters."})}));break;default:n()}}else n()}var W=n(66),$=n(224),K=n(232),z=n(81),G=function(){},H={onInsert:G,onUpdate:G,onReplace:G,onDelete:G};var Q=n(122),V=n.n(Q),X=function(e,t){var n=e.findIndex((function(e){return n=e,r=t,String(null===n||void 0===n?void 0:n._id)===String(null===r||void 0===r?void 0:r._id);var n,r}));return n>=0?n:null};function Y(){var e=P(),t=a.a.useState([]),n=Object(l.a)(t,2),r=n[0],c=n[1],o=a.a.useState(!0),i=Object(l.a)(o,2),d=i[0],f=i[1],p=a.a.useContext(Oe).searchTerm,b=function(e){var t=e.cluster,n=void 0===t?"mongodb-atlas":t,r=e.db,c=e.collection,o=P();return a.a.useMemo((function(){return o.currentUser.mongoClient(n).db(r).collection(c)}),[o.currentUser,n,r,c])}({cluster:A.c,db:"sample_airbnb",collection:"listingsAndReviews"}),j=a.a.useCallback(V()((function(e){var t=[];e&&t.push({$search:{text:{query:e,path:"name"}}}),t.push({$limit:10}),b.aggregate(t).then((function(e){c(e),f(!1)}))}),1e3,{leading:!0}),[b]);return a.a.useEffect((function(){j(p)}),[p]),function(e,t){var n=a.a.useMemo((function(){return{}}),[]),r=Object(v.a)(Object(v.a)({},H),t),c=a.a.useRef(r);a.a.useEffect((function(){c.current={onInsert:r.onInsert,onUpdate:r.onUpdate,onReplace:r.onReplace,onDelete:r.onDelete}}),[r.onInsert,r.onUpdate,r.onReplace,r.onDelete]),a.a.useEffect((function(){!function(){var t=Object(u.a)(s.a.mark((function t(){var r,a,o,i,u,l,d;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,a=!1,t.prev=2,i=Object(z.a)(e.watch({filter:n}));case 4:return t.next=6,i.next();case 6:return u=t.sent,r=u.done,t.next=10,u.value;case 10:if(l=t.sent,r){t.next=28;break}d=l,t.t0=d.operationType,t.next="insert"===t.t0?16:"update"===t.t0?18:"replace"===t.t0?20:"delete"===t.t0?22:24;break;case 16:return c.current.onInsert(d),t.abrupt("break",25);case 18:return c.current.onUpdate(d),t.abrupt("break",25);case 20:return c.current.onReplace(d),t.abrupt("break",25);case 22:return c.current.onDelete(d),t.abrupt("break",25);case 24:throw new Error("Invalid change operation type: ".concat(d.operationType));case 25:r=!0,t.next=4;break;case 28:t.next=34;break;case 30:t.prev=30,t.t1=t.catch(2),a=!0,o=t.t1;case 34:if(t.prev=34,t.prev=35,r||null==i.return){t.next=39;break}return t.next=39,i.return();case 39:if(t.prev=39,!a){t.next=42;break}throw o;case 42:return t.finish(39);case 43:return t.finish(34);case 44:case"end":return t.stop()}}),t,null,[[2,30,34,44],[35,,39,43]])})));return function(){return t.apply(this,arguments)}}()()}),[e,n])}(b,{onInsert:function(e){c((function(t){var n;if(d)return t;var r=null!==(n=X(t,e.fullDocument))&&void 0!==n?n:t.length;return r===t.length?function(e,t,n){if(!N(e,t)&&t!==e.length)throw new Error("Cannot add value. Array index out of bounds.");return[].concat(Object(_.a)(e.slice(0,t)),[n],Object(_.a)(e.slice(t)))}(t,r,e.fullDocument):t}))},onUpdate:function(e){c((function(t){return d?t:function(e,t,n){if(!N(e,t))throw new Error("Cannot update value. Array index out of bounds.");return[].concat(Object(_.a)(e.slice(0,t)),[n(e[t])],Object(_.a)(e.slice(t+1)))}(t,X(t,e.fullDocument),(function(){return e.fullDocument}))}))},onReplace:function(e){c((function(t){return d?t:function(e,t,n){if(!N(e,t))throw new Error("Cannot replace value. Array index out of bounds.");return[].concat(Object(_.a)(e.slice(0,t)),[n],Object(_.a)(e.slice(t+1)))}(t,X(t,e.fullDocument),e.fullDocument)}))},onDelete:function(e){c((function(t){if(d)return t;var n=X(t,{_id:e.documentKey._id});return n>=0?function(e,t){if(!N(e,t))throw new Error("Cannot remove value. Array index out of bounds.");return[].concat(Object(_.a)(e.slice(0,t)),Object(_.a)(e.slice(t+1)))}(t,n):t}))}}),{loading:d,listings:r,saveListing:function(){var t=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.summary){t.next=11;break}return n._partition=e.currentUser.id,t.prev=2,t.next=5,b.insertOne(n);case 5:t.next=11;break;case 7:t.prev=7,t.t0=t.catch(2),t.t0.error.match(/^Duplicate key error/)&&console.warn("The following error means that we tried to insert a listing multiple times (i.e. an existing listing has the same _id). In this app we just catch the error and move on. In your app, you might want to debounce the save input or implement an additional loading state to avoid sending the request in the first place."),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e){return t.apply(this,arguments)}}(),toggleListing:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.updateOne({_id:t._id},{$set:{isComplete:!t.isComplete}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteListing:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.deleteOne({_id:t._id});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),debounceSearchListings:j}}var Z=n(222),ee=n(223);function te(e){var t,n=e.listing;e.listingActions;return Object(U.jsxs)(g.a,{sx:{maxWidth:345},children:[Object(U.jsx)(Z.a,{component:"img",alt:n.name,height:"140",image:null===n||void 0===n||null===(t=n.images)||void 0===t?void 0:t.picture_url}),Object(U.jsxs)(ee.a,{children:[Object(U.jsx)(j.a,{gutterBottom:!0,variant:"h5",component:"div",children:n.name}),Object(U.jsx)(j.a,{variant:"body2",children:n.summary})]})]})}function ne(e,t){var n,r,c=a.a.useState(!1),o=Object(l.a)(c,2),i=o[0],s=o[1];return n=function(){e&&s(!0)},r=[t],a.a.useEffect((function(){var e=setTimeout((function(){n()}),r);return function(){return clearTimeout(e)}}),[n,r]),a.a.useEffect((function(){e||s(!1)}),[e]),i}function re(){var e=Y(),t=e.loading,n=e.listings,r=Object(W.a)(e,["loading","listings"]),a=ne(t,200);return Object(U.jsx)(x.a,{className:"main-container",maxWidth:"sm",children:t?a?Object(U.jsx)($.a,{}):null:Object(U.jsx)("div",{className:"todo-items-container",children:Object(U.jsx)(K.a,{style:{width:"100%"},children:n.map((function(e){return Object(U.jsx)(te,{listing:e,listingActions:r},String(e._id))}))})})})}var ae=n(125),ce=n(226),oe=n(93),ie=n(225),se=n(92),ue=n(91),le={green:Object(v.a)(Object(v.a)({},oe.a),{},{500:"#09804C",A400:"#B9EACD"}),purple:Object(v.a)(Object(v.a)({},ie.a),{},{500:"#6200EE",A400:"#9795F9"}),orange:se.a,red:ue.a},de={palette:{primary:le.purple,secondary:le.purple}},fe=Object(ae.a)(de);function pe(e){var t=e.children;return Object(U.jsx)(ce.a,{theme:fe,children:t})}function be(){var e=a.a.useContext(ve).setPage;return Object(U.jsx)(j.a,{className:"app-bar-title",component:"h1",variant:"h5",style:{cursor:"pointer"},onClick:function(){return e("home")},children:"The eCommerce App by Kit-t"})}var je=n(123),he=n.n(je);n(189);function me(){return Object(U.jsx)(pe,{children:Object(U.jsx)(R,{appId:A.a,children:Object(U.jsx)(xe,{})})})}var ve=a.a.createContext("home"),Oe=a.a.createContext();function xe(){var e=P(),t=e.currentUser,n=e.logOut,r=e.logIn,c=a.a.useState("home"),o=Object(l.a)(c,2),i=o[0],h=o[1],v=a.a.useState(),x=Object(l.a)(v,2),g=x[0],w=x[1];return a.a.useEffect((function(){t||r(O.b.anonymous())}),[]),Object(U.jsx)(ve.Provider,{value:{page:i,setPage:h},children:Object(U.jsx)(Oe.Provider,{value:{searchTerm:g,setSearchTerm:w},children:Object(U.jsx)("div",{className:"App",children:t?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(f.a,{position:"sticky",children:Object(U.jsxs)(p.a,{children:[Object(U.jsx)(be,{}),Object(U.jsx)("div",{style:{paddingRight:"1em",flex:2},children:Object(U.jsx)(he.a,{value:g,onChange:function(e){return w(e)},onRequestSearch:function(){return w("".concat(g))}})}),Object(U.jsx)("div",{style:{flex:1,display:"flex",justifyContent:"end"},children:"anon-user"!==t.providerType?Object(U.jsx)(b.a,{variant:"contained",color:"secondary",onClick:Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:case"end":return e.stop()}}),e)}))),children:Object(U.jsx)(j.a,{variant:"button",children:"Logout"})}):Object(U.jsx)(m.a,{fontSize:"large",style:{paddingRight:"16px",cursor:"pointer"},onClick:function(){return h("profile")}})})]})}),"anon-user"===t.providerType&&"profile"===i?Object(U.jsx)(q,{}):Object(U.jsx)(re,{})]}):Object(U.jsx)(d.a,{})})})})}var ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,233)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)(me,{})}),document.getElementById("root")),ge()},48:function(e){e.exports=JSON.parse('{"a":"devhackathon2022-bqftl","b":"https://realm.mongodb.com","c":"mongodb-atlas"}')}},[[190,1,2]]]);